<%= simple_form_for(@meal, html: { class: 'form-horizontal' }) do |f| %>

  <%= f.input :served_at, as: :datetime_picker,
    input_html: {data: {date_options: {minDate: @min_date}}} %>

  <%= f.input :title %>

  <div class="form-group text optional
    <%= @meal.errors['invitations'].present? ? "has-error" : "" %>">
    <label class="text optional col-sm-2 control-label" for="meal_invitations">Communities</label>
    <div class="boxes col-sm-6">
      <% @communities.each do |c| %>
        <%= check_box_tag("meal[community_boxes][#{c.id}]", "1", @meal.community_ids.include?(c.id)) %>
        <%= label_tag("meal[community_boxes][#{c.id}]", c.name) %>
        &nbsp;&nbsp;
      <% end %>
    </div>
    <% if @meal.errors['allergens'].present? %>
      <div class="help-block col-sm-6 col-sm-offset-2"><%= @meal.errors['allergens'].join %></div>
    <% end %>
  </div>

  <%= f.input :capacity, min: 1 %>

  <%= f.simple_fields_for :head_cook, @meal.head_cook do |head_cook| %>
    <%= render('head_cook_fields', f: head_cook) %>
  <% end %>

  <%= f.simple_fields_for :asst_cooks do |asst_cook| %>
    <%= render('asst_cook_fields', f: asst_cook) %>
  <% end %>

  <!-- Can't use class="row" as it breaks cocoon -->
  <div class="links col-sm-10 col-sm-offset-2">
    <%= link_to_add_association 'Add Assistant Cook', f, :asst_cooks %>
  </div>

  <%= f.simple_fields_for :cleaners do |cleaner| %>
    <%= render('cleaner_fields', f: cleaner) %>
  <% end %>

  <div class="links col-sm-10 col-sm-offset-2">
    <%= link_to_add_association 'Add Cleaner', f, :cleaners %>
  </div>

  <% %w(entrees side kids dessert notes).each do |attrib| %>
    <%= f.input attrib %>
  <% end %>

  <div class="form-group text optional meal_allergens
    <%= @meal.errors['allergens'].present? ? "has-error" : "" %>">
    <label class="text optional col-sm-2 control-label" for="meal_allergens">Allergens</label>
    <div class="boxes col-sm-6">
      <% Meal::ALLERGENS.each do |allergen| %>
        <div>
          <%= f.check_box("allergen_#{allergen}") %>
          <%= f.label("allergen_#{allergen}")%>
        </div>
      <% end %>
    </div>
    <% if @meal.errors['allergens'].present? %>
      <div class="help-block col-sm-6 col-sm-offset-2"><%= @meal.errors['allergens'].join %></div>
    <% end %>
  </div>

  <div class="row">
    <div class="form-actions col-sm-8">
      <%= f.button :submit, class: "pull-right" %>
    </div>
  </div>

<% end %>
